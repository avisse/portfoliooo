<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Uptime Kuma — CI/CD GitHub Actions (runner self-hosted) | Steve Avisse</title>
  <meta name="description" content="Déploiement automatisé d’Uptime Kuma sur VM Debian via GitHub Actions (runner self-hosted) et Docker Compose : reproductibilité, persistance, traçabilité.">
  <meta name="keywords" content="DevOps, CI/CD, GitHub Actions, self-hosted runner, Uptime Kuma, Docker Compose, Debian, supervision, pipeline, automatisation">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/icofont/icofont.min.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/venobox/venobox.css" rel="stylesheet">
  <link href="assets/vendor/owl.carousel/assets/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- Styles locaux (squelette commun) -->
  <style>
    :root{
      --accent:#f2559e;
      --accent2:#007bff;
      --ink:#0b1420;
    }
    .lead-intro{ font-size:1.05rem; line-height:1.6; color:#4a5568; margin:6px 0 18px; }
    .accent{color:var(--accent); font-weight:700;}
    .tech-tags{margin:8px 0 18px; display:flex; flex-wrap:wrap; gap:8px;}
    .tag{
      background:rgba(242,85,158,.08); color:#b71862; border:1px solid rgba(242,85,158,.25);
      padding:4px 10px; border-radius:999px; font-size:.85rem; font-weight:600;
    }
    .btn-ghost{
      display:inline-block; padding:10px 14px; border-radius:10px; font-weight:600;
      border:2px solid var(--accent2); color:var(--accent2); text-decoration:none;
    }
    .btn-ghost:hover{ background:var(--accent2); color:#fff; }
    pre{ background:#0f172a; color:#e2e8f0; padding:14px; border-radius:12px; overflow:auto; }
    pre code{ font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size:.92rem; }
    .soft{ color:#94a3b8; }
    .faq-item{ border-bottom:1px solid #e9ecef; padding:14px 0; }
    .question{ cursor:pointer; font-weight:700; padding-right:24px; position:relative; color:#1f2937;}
    .answer{ max-height:0; overflow:hidden; transition:max-height .3s ease; }
    .arrow-icon{ position:absolute; right:0; top:0; transition:transform .3s ease; color:var(--accent2);}
    .answer-visible .arrow-icon{ transform:rotate(180deg); }
    .portfolio-details-carousel img{ border-radius:14px; }
  </style>
</head>

<body>

  <main id="main">
    <!-- ======= Portfolio Details ======= -->
    <section id="portfolio-details" class="portfolio-details">
      <div class="container" data-aos="fade-up">

        <div class="row">

          <!-- Colonne gauche : carrousel -->
          <div class="col-lg-8">
            <h2 class="portfolio-title" style="text-align:center; color: var(--accent2);">
              DevOps — Déploiement automatisé d’<span class="accent">Uptime Kuma</span> (CI/CD GitHub Actions)
            </h2>

            <div class="owl-carousel portfolio-details-carousel">
               <img src="assets/img/deploy yml pour self-hosted runner (ta VM locale)..jpg" class="img-fluid" alt="Workflow YAML pour runner self-hosted">
  <img src="assets/img/deploiement runner ok .jpg" class="img-fluid" alt="Déploiement du runner OK">
  <img src="assets/img/autaurisatioon.jpg" class="img-fluid" alt="Autorisation / configuration">
  <img src="assets/img/authorized_keys.jpg" class="img-fluid" alt="Fichier authorized_keys préparé">
  <img src="assets/img/Démarrer le runner.jpg" class="img-fluid" alt="Démarrage du runner">
  <img src="assets/img/kuma accessible ! .jpg" class="img-fluid" alt="Uptime Kuma accessible sur le port 3010">
  <img src="assets/img/Deployement runner ok ! .jpg" class="img-fluid" alt="Job GitHub Actions réussi">
  <img src="assets/img/gitruner .jpg" class="img-fluid" alt="Runner enregistré côté GitHub">
  <img src="assets/img/runner opérationnelle et a l'ecoute.jpg" class="img-fluid" alt="Runner opérationnel et à l’écoute">
  <img src="assets/img/Les secrets GitHub Actions servent à sécuriser et automatiser le déploiement.jpg" class="img-fluid" alt="Secrets GitHub Actions">
  <img src="assets/img/test read me ok  verification.jpg" class="img-fluid" alt="Commit README déclenche le pipeline">
  <img src="assets/img/uptime kuma ok .jpg" class="img-fluid" alt="Uptime Kuma en ligne après déploiement">
  <img src="assets/img/VM_SSH_KEY .jpg" class="img-fluid" alt="Clé privée locale (démonstration)">
  <img src="assets/img/tableau de bord kuma.jpg" class="img-fluid" alt="Tableau de bord Uptime Kuma avec sondes">
  <img src="assets/img/test read me genere.jpg" class="img-fluid" alt="Push README effectué côté Git">

</div>

          </div>

          <!-- Colonne droite : résumé / tags -->
          <div class="col-lg-4 portfolio-info">
            <h3 style="text-align:center"><strong>Pipeline CI/CD local, simple et traçable</strong></h3>

            <p class="lead-intro">
              Objectif : <strong>industrialiser</strong> le déploiement d’<em>Uptime Kuma</em> sur une VM
              <strong>Debian</strong> locale. Un <strong>push Git</strong> déclenche automatiquement le
              <strong>déploiement</strong> via un <em>runner GitHub Actions auto-hébergé</em>, en s’appuyant sur
              <strong>Docker Compose</strong> pour la reproductibilité et la <em>persistance</em> des données.
            </p>

            <div class="tech-tags">
              <span class="tag">GitHub Actions</span>
              <span class="tag">Runner self-hosted</span>
              <span class="tag">Docker Compose</span>
              <span class="tag">Debian 12</span>
              <span class="tag">Uptime Kuma</span>
              <span class="tag">CI/CD</span>
            </div>

            <ul style="margin-bottom:14px">
              <li><strong>Critères</strong> : déploiement auto sur push, accès <code>http://IP:3010</code>, données persistantes</li>
              <li><strong>Livrables</strong> : <code>docker-compose.yml</code>, <code>.github/workflows/deploy.yml</code>, runner installé en service</li>
              <li><strong>Traçabilité</strong> : commits + logs GitHub Actions</li>
            </ul>

    
            <p>
              <a class="btn-ghost" href="https://github.com/avisse/uptime-kuma-cicd.git" target="_blank" rel="noopener">
                Voir le repository GitHub
              </a>
            </p>
   
          </div>

          <!-- ======= Accordéons détaillés (pleine largeur) ======= -->
          <div class="col-lg-12 portfolio-info" style="margin-top:24px">

            <!-- 1) Contexte & intention -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a1', this)">
                1) Contexte & intention
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a1">
                <p>
                  Je veux <strong>garder l’exécution chez moi</strong> (pas d’SSH ouvert), obtenir des
                  <strong>déploiements reproductibles</strong> avec Docker Compose, et <strong>tracer</strong> qui
                  déploie quoi/quand (commits + logs Actions). Le tout doit rester <em>simple</em>, <em>sécurisé</em>,
                  <em>rapide à rejouer</em>.
                </p>
              </div>
            </div>

            <!-- 2) Résultat attendu -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a2', this)">
                2) Résultat attendu (critères d’acceptation)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a2">
                <ul>
                  <li>Un <code>docker-compose.yml</code> versionné (port 3010, volume <code>./data</code>).</li>
                  <li>Un workflow <code>.github/workflows/deploy.yml</code> qui déploie sur chaque <em>push</em> de <code>main</code>.</li>
                  <li>Un <strong>runner self-hosted</strong> installé en service sur la VM Debian.</li>
                  <li>L’appli accessible sur <code>http://&lt;IP_VM&gt;:3010</code>, données persistantes entre redéploiements.</li>
                </ul>
              </div>
            </div>

            <!-- 3) Architecture -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a3', this)">
                3) Architecture cible (vue d’ensemble)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a3">
<pre><code>[Mon PC] --push--> [Repo GitHub: uptime-kuma-cicd]
                         |
                         v  (GitHub Actions)
                [Runner self-hosted sur VM Debian]
                         |
                         v
                  Docker + Docker Compose
                         |
                  [Container Uptime Kuma]
               3010 (hôte) --> 3001 (conteneur)
                   ./data --> /app/data (volume)</code></pre>
              </div>
            </div>

            <!-- 4) Pré-requis -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a4', this)">
                4) Pré-requis techniques
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a4">
<pre><code class="language-bash"># Sur la VM Debian
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER   # se reconnecter ensuite
docker compose version          # Compose v2

# Sur mon poste
git installé + accès GitHub
Port 3010 libre sur la VM</code></pre>
              </div>
            </div>

            <!-- 5) Mise en place du code -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a5', this)">
                5) Mise en place du code (structure & Compose)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a5">
<pre><code>uptime-kuma-cicd/
├─ docker-compose.yml
└─ .github/
   └─ workflows/
      └─ deploy.yml</code></pre>

                <p><strong>docker-compose.yml</strong> — persistance, port non conflictuel, redémarrage automatique :</p>
<pre><code class="language-yaml">version: "3"
services:
  uptime-kuma:
    image: louislam/uptime-kuma:latest
    container_name: uptime-kuma
    ports:
      - "3010:3001"           # 3010 hôte -> 3001 conteneur
    volumes:
      - ./data:/app/data      # persistance des sondes & historique
    restart: unless-stopped</code></pre>
              </div>
            </div>

            <!-- 6) Init Git -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a6', this)">
                6) Initialisation Git & publication
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a6">
<pre><code class="language-bash">git init
git remote add origin https://github.com/&lt;mon-user&gt;/uptime-kuma-cicd.git
git add .
git commit -m "Initial commit - compose + workflow"
git branch -M main
git push -u origin main</code></pre>
              </div>
            </div>

            <!-- 7) Runner self-hosted -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a7', this)">
                7) Installation du runner GitHub Actions (self-hosted)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a7">
<pre><code class="language-bash">mkdir -p ~/actions-runner &amp;&amp; cd ~/actions-runner
curl -o actions-runner.tar.gz -L https://github.com/actions/runner/releases/download/v2.326.0/actions-runner-linux-x64-2.326.0.tar.gz
tar xzf actions-runner.tar.gz

# Lier le runner à TON dépôt
./config.sh --url https://github.com/&lt;mon-user&gt;/uptime-kuma-cicd --token &lt;TOKEN&gt;

# Lancer en service
sudo ./svc.sh install
sudo ./svc.sh start
sudo ./svc.sh status   # doit être "active"</code></pre>
                <p class="soft">Je note le <em>label</em> associé (par défaut <code>self-hosted</code>), que je cible dans le workflow.</p>
              </div>
            </div>

            <!-- 8) Workflow Actions -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a8', this)">
                8) Workflow GitHub Actions (le « cerveau » du déploiement)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a8">
<pre><code class="language-yaml"># .github/workflows/deploy.yml
name: Deploy Uptime Kuma to VM

on:
  push:
    branches: [ "main" ]
  workflow_dispatch: {}   # déclenchement manuel possible

jobs:
  deploy:
    runs-on: self-hosted

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Ensure working dir exists
        run: mkdir -p "$GITHUB_WORKSPACE/data"

      - name: Deploy with Docker Compose
        run: |
          cd "$GITHUB_WORKSPACE"
          docker compose pull
          docker compose up -d --remove-orphans</code></pre>
                <p>Le workflow <em>rejoue</em> proprement : il tire l’image et relance la stack (idempotent).</p>
              </div>
            </div>

            <!-- 9) Déclenchement & vérification -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('a9', this)">
                9) Déclenchement & vérification
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="a9">
<pre><code class="language-bash"># Depuis mon poste
git add .
git commit -m "MAJ conf / nouveau monitor par défaut"
git push

# Sur la VM (contrôle)
docker ps
curl -I http://&lt;IP_VM&gt;:3010</code></pre>
                <p>Je termine l’initialisation via l’UI (création de l’admin), puis j’ajoute quelques sondes.</p>
              </div>
            </div>

            <!-- 10) Mise en route Kuma -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('b0', this)">
                10) Configuration Uptime Kuma (mise en route)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="b0">
                <ul>
                  <li>Monitors HTTP(s) vers Rocket.Chat / GLPI / Heimdall (toutes les 60 s).</li>
                  <li>Monitor PING sur une passerelle / DNS interne.</li>
                  <li>Notifications (mail/webhook) si besoin.</li>
                </ul>
              </div>
            </div>

            <!-- 11) Sécurité & conformité -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('b1', this)">
                11) Sécurité & conformité
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="b1">
                <ul>
                  <li><strong>Pas d’SSH exposé</strong> : le job tourne <em>sur</em> la VM via le runner.</li>
                  <li>Utilisateur dans le groupe <code>docker</code> (pas de <code>sudo</code> partout).</li>
                  <li><strong>Persistance</strong> : <code>./data</code> sauvegardable/restaurable facilement.</li>
                  <li>Ports : choix du <code>3010</code> pour éviter les collisions.</li>
                </ul>
              </div>
            </div>

            <!-- 12) Exploitation -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('b2', this)">
                12) Exploitation (runbook)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="b2">
<pre><code class="language-bash"># Sauvegarde du volume
tar czf uptime-kuma-data_$(date +%F).tar.gz -C "$GITHUB_WORKSPACE" data

# Restauration
tar xzf uptime-kuma-data_YYYY-MM-DD.tar.gz -C "$GITHUB_WORKSPACE"
docker compose up -d

# Mise à jour forcée
docker compose pull &amp;&amp; docker compose up -d

# Rollback par version
# 1) Pinner un tag (ex: louislam/uptime-kuma:1.23.x) dans compose.yml, commit/push
# 2) Ou restaurer l’archive de data si le souci est lié aux données</code></pre>
              </div>
            </div>

            <!-- 13) Problèmes & résolutions -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('b3', this)">
                13) Problèmes rencontrés & résolutions
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="b3">
                <ul>
                  <li><strong>Port en conflit</strong> → mappage <code>3010:3001</code> au lieu de <code>3001:3001</code>.</li>
                  <li><strong>Runner inactif</strong> → <code>sudo ./svc.sh status/start</code> et reconfig si besoin.</li>
                  <li><strong>Volume absent</strong> → étape “Ensure working dir exists” dans le workflow.</li>
                  <li><strong>Pull impossible</strong> (réseau) → tester <code>ping registry-1.docker.io</code>, proxy si nécessaire.</li>
                  <li><strong>Non-redémarrage</strong> après reboot → <code>restart: unless-stopped</code> ajouté.</li>
                </ul>
              </div>
            </div>

            <!-- 14) Principes de conception -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('b4', this)">
                14) Pourquoi ces choix (principes)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="b4">
                <ul>
                  <li><strong>Minimalisme</strong> : un compose + un workflow → lisible, transmissible.</li>
                  <li><strong>Exécution locale</strong> : runner self-hosted → surface d’attaque réduite.</li>
                  <li><strong>Idempotence</strong> : <code>docker compose up -d</code> supporte les rejouages.</li>
                  <li><strong>Traçabilité</strong> : chaque déploiement est lié à un commit.</li>
                </ul>
              </div>
            </div>

            <!-- 15) Roadmap -->
            <div class="faq-item">
              <div class="question" onclick="toggleAnswer('b5', this)">
                15) Améliorations possibles (roadmap)
                <span class="arrow-icon">▼</span>
              </div>
              <div class="answer" id="b5">
                <ul>
                  <li>Tagging de versions (release) pour déployer un tag précis.</li>
                  <li>Reverse proxy + HTTPS (Traefik/Nginx/Caddy) → <code>https://kuma.local</code>.</li>
                  <li>Backups planifiés (cron + NAS/artefacts).</li>
                  <li>Job planifié (<code>on: schedule</code>) pour tirer l’image la nuit.</li>
                  <li>Exports/partage des dashboards de disponibilité.</li>
                </ul>
              </div>
            </div>

          </div><!-- /col-12 -->

        </div><!-- /row -->
      </div><!-- /container -->
    </section><!-- End Portfolio Details -->
  </main><!-- End #main -->

  <a href="#" class="back-to-top"><i class="bx bx-up-arrow-alt"></i></a>
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/jquery/jquery.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/jquery.easing/jquery.easing.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/waypoints/jquery.waypoints.min.js"></script>
  <script src="assets/vendor/counterup/counterup.min.js"></script>
  <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="assets/vendor/venobox/venobox.min.js"></script>
  <script src="assets/vendor/owl.carousel/owl.carousel.min.js"></script>
  <script src="assets/vendor/typed.js/typed.min.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

  <!-- Accordéons -->
  <script>
    function toggleAnswer(answerId, question){
      var answer = document.getElementById(answerId);
      answer.classList.toggle("answer-visible");
      question.classList.toggle("answer-visible");
      if (answer.style.maxHeight){
        answer.style.maxHeight = null;
      } else {
        answer.style.maxHeight = answer.scrollHeight + "px";
      }
    }
  </script>
</body>
</html>
